---
phase: 12-quick-explore
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/commands/grd/quick-explore.md
  - .claude/get-research-done/lib/formatters.py
autonomous: true

must_haves:
  truths:
    - "User can invoke /grd:quick-explore command"
    - "Formatters module provides Rich-based formatting utilities"
    - "Sparkline generation works for numerical distributions"
    - "Quality indicators display emoji and color"
  artifacts:
    - path: ".claude/commands/grd/quick-explore.md"
      provides: "Quick explore command skill file"
      min_lines: 80
    - path: ".claude/get-research-done/lib/formatters.py"
      provides: "Rich formatting utilities for terminal output"
      exports: ["generate_sparkline", "get_quality_indicator", "print_tldr", "print_column_table"]
  key_links:
    - from: ".claude/commands/grd/quick-explore.md"
      to: ".claude/agents/grd-explorer.md"
      via: "subagent_type reference"
      pattern: "subagent_type.*grd-explorer"
---

<objective>
Create the quick-explore command and core formatting utilities.

Purpose: Establish the command entry point and reusable Rich-based formatting module that will power the console output for quick explore mode.

Output:
- `/grd:quick-explore` command skill file
- `formatters.py` Python module with Rich formatting utilities
</objective>

<execution_context>
@/Users/evanowen/.claude/get-research-done/workflows/execute-plan.md
@/Users/evanowen/.claude/get-research-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-quick-explore/12-CONTEXT.md
@.planning/phases/12-quick-explore/12-RESEARCH.md
@.claude/commands/grd/explore.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create quick-explore command skill file</name>
  <files>.claude/commands/grd/quick-explore.md</files>
  <action>
Create the quick-explore command skill file following the pattern of explore.md but optimized for fast, console-based output.

Structure:
1. Frontmatter with name: grd:quick-explore, description, allowed-tools (Read, Bash, Write, Task)
2. Objective section explaining quick explore purpose (fast EDA for team sharing)
3. Execution context referencing data-report template
4. Process section with:
   - Phase 1: Setup and Data Path Resolution (same as explore.md)
   - Phase 2: Spawn Explorer Agent with mode="quick" in context
   - Phase 3: Present Results to console (NOT to DATA_REPORT.md initially)
5. Arguments section (path, no --detailed flag for quick mode)
6. Examples section showing usage
7. Output section noting console output + optional DATA_REPORT.md with "Quick Explore" header
8. Success criteria checklist

Key differences from explore.md:
- Mode is hardcoded to "quick" (not a flag)
- Results print to console immediately with Rich formatting
- DATA_REPORT.md marked with "Quick Explore Mode" header
- Banner: "Quick Explore - Run full explore for rigorous analysis"
- Footer: "Run /grd:explore for complete analysis"
- No --detailed flag (quick mode is always fast)

The spawn prompt should include:
```
<profiling_mode>
quick

Quick mode:
- TL;DR prose summary at top
- One-line-per-column table with sparklines
- Distribution highlights with skewness flags
- Data quality warnings with emoji indicators
- Basic leakage heuristics only (skip expensive analysis)
- Output to console AND write DATA_REPORT.md with Quick Explore header
</profiling_mode>
```
  </action>
  <verify>
File exists with correct structure:
```bash
test -f .claude/commands/grd/quick-explore.md && grep -q "grd:quick-explore" .claude/commands/grd/quick-explore.md && grep -q "mode.*quick" .claude/commands/grd/quick-explore.md
```
  </verify>
  <done>quick-explore.md command file exists with mode="quick" in spawn prompt, banner text, and footer reminder</done>
</task>

<task type="auto">
  <name>Task 2: Create formatters.py Rich formatting module</name>
  <files>.claude/get-research-done/lib/formatters.py</files>
  <action>
Create the formatters.py module with Rich-based formatting utilities for quick explore output.

Directory structure - first ensure lib/ directory exists:
```bash
mkdir -p .claude/get-research-done/lib
touch .claude/get-research-done/lib/__init__.py
```

Implement the following functions in formatters.py:

1. **generate_sparkline(series: pd.Series) -> str**
   - Generate Unicode sparkline for numerical column distribution
   - Use histogram with 20 bins, then sparklines package
   - Return "â€”" for non-numeric or empty data
   - Wrap in try-except with fallback

2. **get_quality_indicator(series: pd.Series, missing_pct: float) -> str**
   - Return emoji indicator based on data quality
   - Missing >50%: "HIGH MISSING"
   - Missing >20%: "MISSING"
   - Numerical outliers >5%: "OUTLIERS" (Z-score >3)
   - Categorical cardinality >95%: "HIGH CARD"
   - Otherwise: checkmark
   - Use Rich emoji support detection for fallbacks

3. **print_header_banner(console: Console)**
   - Print yellow panel with "Quick Explore Mode" and warning text
   - Include suggestion to run full explore

4. **print_tldr(console: Console, df: pd.DataFrame, target_col: str = None) -> str**
   - Generate and print 2-3 sentence prose summary
   - Include row count, column count, memory usage
   - Highlight notable issues (high missing, duplicates, outliers)
   - Return the TL;DR text for DATA_REPORT.md

5. **print_column_table(console: Console, df: pd.DataFrame)**
   - Print one-line-per-column Rich table
   - Columns: Name, Type, Missing%, Key Stat, Distribution (sparkline), Indicator
   - Style rows with warnings in yellow/red

6. **print_distribution_highlights(console: Console, df: pd.DataFrame)**
   - Print skewness flags for numerical columns
   - Symmetric, right-skewed, left-skewed indicators
   - Use colors: green for symmetric, yellow for skewed

7. **print_quality_warnings(console: Console, df: pd.DataFrame)**
   - Print consolidated data quality warnings
   - Duplicates, high missing columns, potential issues

8. **print_footer(console: Console)**
   - Print dim footer with suggestion to run full explore

Include imports:
```python
from rich.console import Console
from rich.table import Table
from rich.panel import Panel
from rich.markdown import Markdown
import pandas as pd
import numpy as np
from scipy.stats import skew
try:
    from sparklines import sparklines
except ImportError:
    sparklines = None  # Fallback handled in generate_sparkline
```

Add docstrings and type hints to all functions.
  </action>
  <verify>
Module imports and functions exist:
```bash
python3 -c "from pathlib import Path; import sys; sys.path.insert(0, str(Path('.claude/get-research-done/lib'))); from formatters import generate_sparkline, get_quality_indicator, print_tldr, print_column_table; print('OK')"
```
  </verify>
  <done>formatters.py exists with all 8 formatting functions, proper imports, docstrings, and type hints</done>
</task>

</tasks>

<verification>
1. quick-explore.md command file exists with correct frontmatter
2. formatters.py module exists with all required functions
3. Python imports work without errors
4. Command references grd-explorer agent with quick mode
</verification>

<success_criteria>
- [ ] /grd:quick-explore command skill file created
- [ ] formatters.py module created with Rich formatting utilities
- [ ] All functions have docstrings and type hints
- [ ] Module imports successfully in Python
- [ ] Command file follows explore.md pattern
</success_criteria>

<output>
After completion, create `.planning/phases/12-quick-explore/12-01-SUMMARY.md`
</output>
