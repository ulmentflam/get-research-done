---
phase: 04-recursive-validation-loop
plan: 05
type: execute
wave: 3
depends_on: ["04-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Complete loop workflow verified: Researcher -> Critic -> Evaluator/Researcher/Explorer"
    - "Iteration limit triggers human gate correctly"
    - "All routing paths work as designed"
  artifacts: []
  key_links:
    - from: "commands/grd/research.md"
      to: "agents/grd-researcher.md"
      via: "agent spawn"
      pattern: "grd-researcher"
    - from: "agents/grd-researcher.md"
      to: "agents/grd-critic.md"
      via: "Task spawn"
      pattern: "grd-critic"
    - from: "agents/grd-critic.md"
      to: "agents/grd-evaluator.md"
      via: "Task spawn for PROCEED"
      pattern: "grd-evaluator"
---

<objective>

Verify the complete recursive validation loop integration and get human approval.

Purpose: This plan verifies all Phase 4 components work together correctly: command -> Researcher -> Critic -> routing -> Evaluator/loop/Explorer. Final human approval confirms the loop is ready for production use.

Output:
- Verification that all files properly reference each other
- Verification that routing logic is complete
- Human approval checkpoint

</objective>

<execution_context>

@/Users/evanowen/.claude/get-research-done/workflows/execute-plan.md
@/Users/evanowen/.claude/get-research-done/templates/summary.md

</execution_context>

<context>

@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-recursive-validation-loop/04-CONTEXT.md

Reference all Phase 4 artifacts:
@commands/grd/research.md
@agents/grd-researcher.md
@agents/grd-critic.md
@agents/grd-evaluator.md
@get-research-done/templates/critic-log.md
@get-research-done/templates/scorecard.json
@get-research-done/templates/experiment-readme.md
@get-research-done/templates/state.md

</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify file structure and references</name>
  <files></files>
  <action>
Verify all Phase 4 artifacts exist and properly reference each other.

**File existence checks:**
```bash
# Command
test -f commands/grd/research.md && echo "PASS: research.md exists"

# Agents
test -f agents/grd-researcher.md && echo "PASS: grd-researcher.md exists"
test -f agents/grd-critic.md && echo "PASS: grd-critic.md exists"
test -f agents/grd-evaluator.md && echo "PASS: grd-evaluator.md exists"

# Templates
test -f get-research-done/templates/critic-log.md && echo "PASS: critic-log.md exists"
test -f get-research-done/templates/scorecard.json && echo "PASS: scorecard.json exists"
test -f get-research-done/templates/experiment-readme.md && echo "PASS: experiment-readme.md exists"
```

**Reference chain verification:**
```bash
# Command -> Researcher
grep -q "grd-researcher" commands/grd/research.md && echo "PASS: Command references Researcher"

# Researcher -> Critic
grep -q "grd-critic" agents/grd-researcher.md && echo "PASS: Researcher references Critic"

# Researcher -> Evaluator (for PROCEED routing)
grep -q "grd-evaluator" agents/grd-researcher.md && echo "PASS: Researcher references Evaluator"

# Critic -> OBJECTIVE.md
grep -q "OBJECTIVE.md" agents/grd-critic.md && echo "PASS: Critic references OBJECTIVE.md"

# Evaluator -> SCORECARD
grep -q "SCORECARD" agents/grd-evaluator.md && echo "PASS: Evaluator references SCORECARD"

# Researcher -> Explorer (for REVISE_DATA)
grep -q "explore" agents/grd-researcher.md && echo "PASS: Researcher references Explorer"
```

**Routing coverage verification:**
```bash
# All four verdicts in Researcher routing
grep -q "PROCEED" agents/grd-researcher.md && echo "PASS: Handles PROCEED"
grep -q "REVISE_METHOD" agents/grd-researcher.md && echo "PASS: Handles REVISE_METHOD"
grep -q "REVISE_DATA" agents/grd-researcher.md && echo "PASS: Handles REVISE_DATA"
grep -q "ESCALATE" agents/grd-researcher.md && echo "PASS: Handles ESCALATE"

# Iteration limit in Researcher
grep -q "iteration_limit\|iteration limit" agents/grd-researcher.md && echo "PASS: Has iteration limit"

# Human gate
grep -q "Human\|human" agents/grd-researcher.md && echo "PASS: Has human gate"
```

Report any missing files or broken references.
  </action>
  <verify>All checks pass with "PASS:" prefix, no "FAIL:" messages</verify>
  <done>All files exist and reference chain is complete: Command -> Researcher -> Critic -> Evaluator, with REVISE_DATA -> Explorer routing</done>
</task>

<task type="auto">
  <name>Task 2: Verify requirements coverage</name>
  <files></files>
  <action>
Verify all LOOP-* requirements from ROADMAP.md are addressed.

**Requirements checklist:**

```markdown
## LOOP-01: Researcher implements experiments from OBJECTIVE.md
- [ ] grd-researcher reads OBJECTIVE.md (grep for OBJECTIVE.md reference)
- [ ] grd-researcher generates code/notebooks
- [ ] grd-researcher creates run directories

## LOOP-02: Critic audits with exit codes
- [ ] grd-critic has PROCEED verdict
- [ ] grd-critic has REVISE_METHOD verdict
- [ ] grd-critic has REVISE_DATA verdict
- [ ] grd-critic returns structured output with confidence

## LOOP-03: State router implements conditional branching
- [ ] grd-researcher routes based on Critic verdict
- [ ] Routing logic documented in agent

## LOOP-04: REVISE_METHOD routes back to Researcher
- [ ] grd-researcher loops on REVISE_METHOD
- [ ] Previous critique passed to next iteration
- [ ] Iteration count tracked

## LOOP-05: REVISE_DATA routes back to Explorer
- [ ] grd-researcher routes to /grd:explore
- [ ] Specific concerns passed to Explorer
- [ ] User prompted to re-run research after explore

## LOOP-06: Evaluator generates SCORECARD.json
- [ ] grd-evaluator exists
- [ ] grd-evaluator generates SCORECARD.json
- [ ] SCORECARD includes metrics from OBJECTIVE.md

## LOOP-07: Experiment versioning with run_NNN directories
- [ ] Run directories created in experiments/
- [ ] Descriptive naming (run_001_baseline)
- [ ] Archive directory for failed runs
```

Run checks for each requirement:
```bash
# LOOP-01
grep -q "OBJECTIVE.md" agents/grd-researcher.md && echo "LOOP-01: PASS"

# LOOP-02
grep -q "PROCEED\|REVISE_METHOD\|REVISE_DATA" agents/grd-critic.md && echo "LOOP-02: PASS"

# LOOP-03
grep -q "route\|routing" agents/grd-researcher.md && echo "LOOP-03: PASS"

# LOOP-04
grep -q "REVISE_METHOD.*loop\|iteration" agents/grd-researcher.md && echo "LOOP-04: PASS"

# LOOP-05
grep -q "explore\|REVISE_DATA" agents/grd-researcher.md && echo "LOOP-05: PASS"

# LOOP-06
grep -q "SCORECARD" agents/grd-evaluator.md && echo "LOOP-06: PASS"

# LOOP-07
grep -q "run_\|experiments/" agents/grd-researcher.md && echo "LOOP-07: PASS"
```
  </action>
  <verify>All LOOP-* requirements have corresponding implementation in Phase 4 artifacts</verify>
  <done>All 7 LOOP requirements (LOOP-01 through LOOP-07) verified as addressed in Phase 4 artifacts</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete recursive validation loop for GRD Phase 4:
- /grd:research command to start experiment implementation
- grd-researcher agent with 8-step workflow and loop orchestration
- grd-critic agent with LLM-based routing (PROCEED/REVISE_METHOD/REVISE_DATA/ESCALATE)
- grd-evaluator agent with quantitative benchmarking and SCORECARD.json
- Templates: experiment-readme.md, critic-log.md, scorecard.json
- STATE.md extended with loop tracking
- Iteration limits (default: 5) with human decision gate
- Cycle detection to prevent infinite loops
  </what-built>
  <how-to-verify>
1. Review file structure:
   ```bash
   ls -la commands/grd/research.md agents/grd-*.md
   ls -la get-research-done/templates/critic-log.md get-research-done/templates/scorecard.json
   ```

2. Verify key sections in grd-researcher.md:
   - Step 7: Spawn Critic
   - Step 7.5: Handle Critic Verdict Routing (all four verdicts)
   - Step 8: Human Decision Gate
   - Iteration tracking variables

3. Verify grd-critic.md has:
   - LLM-based routing (not rule-based)
   - Confidence levels (HIGH/MEDIUM/LOW)
   - Structured critique output format

4. Verify grd-evaluator.md has:
   - SCORECARD.json generation
   - Composite score calculation
   - MLflow integration (optional)

5. Verify STATE.md template has:
   - Research Loop State section
   - Loop History table
   - Verdict Trend tracking

6. Check alignment with CONTEXT.md decisions:
   - LLM reasoning for routing (not rules)
   - Full history access for Critic
   - Configurable max iterations (default: 5)
   - Human options: Continue/Archive/Reset/Escalate
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 4, or describe issues to address</resume-signal>
</task>

</tasks>

<verification>

After all tasks complete:
1. All Phase 4 files exist and are properly linked
2. All LOOP-* requirements verified as addressed
3. Human approval confirms workflow is complete

</verification>

<success_criteria>

- [ ] All files exist (command, 3 agents, 3 templates)
- [ ] Reference chain complete: Command -> Researcher -> Critic -> Evaluator
- [ ] All routing paths work: PROCEED, REVISE_METHOD, REVISE_DATA, ESCALATE
- [ ] Iteration limit enforced with human gate
- [ ] All LOOP-01 through LOOP-07 requirements addressed
- [ ] Human approved Phase 4 implementation

</success_criteria>

<output>

After completion, create `.planning/phases/04-recursive-validation-loop/04-05-SUMMARY.md`

</output>
