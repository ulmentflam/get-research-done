---
phase: 10-command-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/commands/grd/audit-study.md (create)
  - .claude/commands/grd/plan-study-gaps.md (create)
  - .claude/commands/grd/complete-milestone.md (update references)
  - .claude/commands/grd/verify-work.md (update references)
  - .claude/commands/grd/execute-phase.md (update references)
  - .claude/commands/grd/help.md (add new commands)
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "audit-study command exists and is functional"
    - "plan-study-gaps command exists and is functional"
    - "Workflow commands reference the new study-centric command names"
    - "Help documentation includes audit-study and plan-study-gaps"
  artifacts:
    - path: ".claude/commands/grd/audit-study.md"
      provides: "Study audit workflow"
      contains: "grd:audit-study command with study terminology"
    - path: ".claude/commands/grd/plan-study-gaps.md"
      provides: "Gap planning workflow"
      contains: "grd:plan-study-gaps command with study terminology"
    - path: ".claude/commands/grd/help.md"
      provides: "Command documentation"
      contains: "audit-study and plan-study-gaps commands"
  key_links:
    - from: "complete-milestone.md"
      to: "audit-study"
      via: "Pre-flight check"
      pattern: "/grd:audit-study"
    - from: "verify-work.md"
      to: "audit-study"
      via: "Route B offer_next"
      pattern: "/grd:audit-study"
    - from: "execute-phase.md"
      to: "audit-study"
      via: "Route B offer_next"
      pattern: "/grd:audit-study"
    - from: "audit-study.md"
      to: "plan-study-gaps"
      via: "Next step on gaps_found"
      pattern: "/grd:plan-study-gaps"
---

<objective>
Restore audit and gap planning functionality with study-centric naming. Creates audit-study.md and plan-study-gaps.md based on GSD originals, updates all workflow references.

Purpose: The audit-milestone and plan-milestone-gaps commands were incorrectly identified as GSD-specific. They provide valuable workflow functionality (auditing milestone completion, planning gap closures) that should be preserved with the new terminology.

Output: Two new command files with study terminology, all workflow files updated to reference new names, help.md updated.
</objective>

<execution_context>
@/Users/evanowen/.claude/get-shit-done/workflows/execute-plan.md
@/Users/evanowen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md
@.planning/phases/10-command-cleanup/10-VERIFICATION.md

**Source templates (GSD originals):**
@/Users/evanowen/.claude/commands/gsd/audit-milestone.md
@/Users/evanowen/.claude/commands/gsd/plan-milestone-gaps.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create audit-study.md</name>
  <files>.claude/commands/grd/audit-study.md</files>
  <action>
    Create audit-study.md based on the GSD audit-milestone.md template.

    **Changes from original:**
    1. Name: `grd:audit-study` (was `grd:audit-milestone`)
    2. Description: "Audit study completion against original intent before archiving"
    3. Replace all `/gsd:` references with `/grd:`
    4. Replace `/gsd:audit-milestone` → `/grd:audit-study`
    5. Replace `/gsd:plan-milestone-gaps` → `/grd:plan-study-gaps`
    6. Replace `/gsd:complete-milestone` → `/grd:complete-study` (future, but prepare now)
    7. Keep all other logic, process, and context intact
    8. Spawns gsd-integration-checker (agent name unchanged)

    **Key sections to update:**
    - Line 2: `name: grd:audit-study`
    - Line 3: description with "study" instead of "milestone"
    - Lines 184, 259: `/gsd:complete-milestone` → `/grd:complete-study`
    - Line 221: `/gsd:plan-milestone-gaps` → `/grd:plan-study-gaps`

    Copy from: /Users/evanowen/.claude/commands/gsd/audit-milestone.md
    Write to: .claude/commands/grd/audit-study.md
  </action>
  <verify>
    Run: ls .claude/commands/grd/audit-study.md
    Expected: File exists

    Run: grep -c "grd:audit-study" .claude/commands/grd/audit-study.md
    Expected: >= 1 (name defined)

    Run: grep -c "gsd:" .claude/commands/grd/audit-study.md
    Expected: 0 (no GSD references remain)
  </verify>
  <done>
    audit-study.md created with study-centric terminology. No GSD references.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create plan-study-gaps.md</name>
  <files>.claude/commands/grd/plan-study-gaps.md</files>
  <action>
    Create plan-study-gaps.md based on the GSD plan-milestone-gaps.md template.

    **Changes from original:**
    1. Name: `grd:plan-study-gaps` (was `grd:plan-milestone-gaps`)
    2. Description: "Create phases to close all gaps identified by study audit"
    3. Replace all `/gsd:` references with `/grd:`
    4. Replace `/gsd:audit-milestone` → `/grd:audit-study`
    5. Replace `/gsd:plan-milestone-gaps` → `/grd:plan-study-gaps`
    6. Replace `/gsd:complete-milestone` → `/grd:complete-study` (future, but prepare now)
    7. Replace `/gsd:plan-phase` → `/grd:plan-study` (future, but prepare now)
    8. Replace `/gsd:execute-phase` → `/grd:run-study` (future, but prepare now)
    9. Keep all other logic, process, and context intact

    **Key sections to update:**
    - Line 2: `name: grd:plan-study-gaps`
    - Line 3: description referencing "study audit"
    - Line 14: reference to `/gsd:audit-milestone` → `/grd:audit-study`
    - Lines 54-55: error message referencing audit command
    - Lines 191-206: next steps section with command references

    Copy from: /Users/evanowen/.claude/commands/gsd/plan-milestone-gaps.md
    Write to: .claude/commands/grd/plan-study-gaps.md
  </action>
  <verify>
    Run: ls .claude/commands/grd/plan-study-gaps.md
    Expected: File exists

    Run: grep -c "grd:plan-study-gaps" .claude/commands/grd/plan-study-gaps.md
    Expected: >= 1 (name defined)

    Run: grep -c "gsd:" .claude/commands/grd/plan-study-gaps.md
    Expected: 0 (no GSD references remain)
  </verify>
  <done>
    plan-study-gaps.md created with study-centric terminology. No GSD references.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update complete-milestone.md references</name>
  <files>.claude/commands/grd/complete-milestone.md</files>
  <action>
    Update the pre-flight check section to reference the new command names.

    **Current state (lines 42-62):**
    - References `/grd:audit-milestone` (deleted, now restoring as audit-study)
    - References `/grd:plan-milestone-gaps` (deleted, now restoring as plan-study-gaps)

    **Change to:**
    - Replace `/grd:audit-milestone` → `/grd:audit-study`
    - Replace `/grd:plan-milestone-gaps` → `/grd:plan-study-gaps`
    - Keep the pre-flight check logic intact (it was useful)

    This restores the original workflow: check for audit → recommend audit if missing → proceed with completion.
  </action>
  <verify>
    Run: grep -c "audit-study" .claude/commands/grd/complete-milestone.md
    Expected: >= 1 (references new command)

    Run: grep -c "plan-study-gaps" .claude/commands/grd/complete-milestone.md
    Expected: >= 1 (references new command)

    Run: grep -c "audit-milestone\|plan-milestone-gaps" .claude/commands/grd/complete-milestone.md
    Expected: 0 (old names replaced)
  </verify>
  <done>
    complete-milestone.md updated to reference /grd:audit-study and /grd:plan-study-gaps.
  </done>
</task>

<task type="auto">
  <name>Task 4: Update verify-work.md Route B</name>
  <files>.claude/commands/grd/verify-work.md</files>
  <action>
    Update Route B (milestone complete route) to reference audit-study.

    **Current state (line 124):**
    - References `/grd:audit-milestone` (deleted, now restoring as audit-study)

    **Change to:**
    - Replace `/grd:audit-milestone` → `/grd:audit-study`
    - Keep the routing logic intact (audit before complete is good workflow)
  </action>
  <verify>
    Run: grep -c "audit-study" .claude/commands/grd/verify-work.md
    Expected: >= 1 (references new command)

    Run: grep -c "audit-milestone" .claude/commands/grd/verify-work.md
    Expected: 0 (old name replaced)
  </verify>
  <done>
    verify-work.md Route B updated to reference /grd:audit-study.
  </done>
</task>

<task type="auto">
  <name>Task 5: Update execute-phase.md Route B</name>
  <files>.claude/commands/grd/execute-phase.md</files>
  <action>
    Update Route B (milestone complete route) to reference audit-study.

    **Current state (lines 196, 204):**
    - References `/grd:audit-milestone` (deleted, now restoring as audit-study)

    **Change to:**
    - Replace `/grd:audit-milestone` → `/grd:audit-study`
    - Keep the routing logic intact (audit before complete is good workflow)
  </action>
  <verify>
    Run: grep -c "audit-study" .claude/commands/grd/execute-phase.md
    Expected: >= 1 (references new command)

    Run: grep -c "audit-milestone" .claude/commands/grd/execute-phase.md
    Expected: 0 (old name replaced)
  </verify>
  <done>
    execute-phase.md Route B updated to reference /grd:audit-study.
  </done>
</task>

<task type="auto">
  <name>Task 6: Add commands to help.md</name>
  <files>.claude/commands/grd/help.md</files>
  <action>
    Add the Study Auditing section to help.md with the two new commands.

    **Add after the "### Phase Planning" section (or appropriate location):**

    ```markdown
    ### Study Auditing

    **`/grd:audit-study [version]`**
    Audit study completion against original intent.
    - Checks requirements coverage across all phases
    - Verifies cross-phase integration and E2E flows
    - Aggregates tech debt and deferred items
    - Creates v{version}-MILESTONE-AUDIT.md report
    - Routes to complete-study or plan-study-gaps based on results

    **`/grd:plan-study-gaps`**
    Create phases to close gaps identified by audit.
    - Reads MILESTONE-AUDIT.md for gap details
    - Groups related gaps into logical phases
    - Prioritizes by requirement priority (must/should/nice)
    - Updates ROADMAP.md with new phases
    - Creates phase directories
    ```

    Find the appropriate section in help.md and add this content.
  </action>
  <verify>
    Run: grep -c "audit-study" .claude/commands/grd/help.md
    Expected: >= 1 (command documented)

    Run: grep -c "plan-study-gaps" .claude/commands/grd/help.md
    Expected: >= 1 (command documented)

    Run: grep -c "Study Auditing" .claude/commands/grd/help.md
    Expected: 1 (section header exists)
  </verify>
  <done>
    help.md updated with Study Auditing section documenting both commands.
  </done>
</task>

</tasks>

<verification>
After all tasks complete, verify phase success criteria:

1. New commands exist:
   ```bash
   ls .claude/commands/grd/audit-study.md .claude/commands/grd/plan-study-gaps.md
   ```
   Expected: Both files exist

2. No GSD references in new commands:
   ```bash
   grep -c "gsd:" .claude/commands/grd/audit-study.md .claude/commands/grd/plan-study-gaps.md
   ```
   Expected: 0 for both files

3. No old command names in workflow files:
   ```bash
   grep -r "audit-milestone\|plan-milestone-gaps" .claude/commands/grd/
   ```
   Expected: No output (empty)

4. New command names in workflow files:
   ```bash
   grep -l "audit-study" .claude/commands/grd/*.md
   ```
   Expected: complete-milestone.md, verify-work.md, execute-phase.md, help.md, audit-study.md

5. File count increased:
   ```bash
   ls -1 .claude/commands/grd/*.md | wc -l
   ```
   Expected: 32 (30 + 2 new commands)
</verification>

<success_criteria>
- [ ] audit-study.md created with GRD terminology
- [ ] plan-study-gaps.md created with GRD terminology
- [ ] complete-milestone.md references new command names
- [ ] verify-work.md references new command names
- [ ] execute-phase.md references new command names
- [ ] help.md documents both new commands
- [ ] Zero references to old command names (audit-milestone, plan-milestone-gaps)
- [ ] Zero GSD references in new command files
- [ ] Final command count is 32 files
</success_criteria>

<output>
After completion, create `.planning/phases/10-command-cleanup/10-02-SUMMARY.md`
</output>
