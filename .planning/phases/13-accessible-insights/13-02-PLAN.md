---
phase: 13-accessible-insights
plan: 02
type: execute
wave: 2
depends_on: ["13-01"]
files_modified:
  - .claude/commands/grd/insights.md
  - .claude/agents/grd-explorer.md
  - .claude/commands/grd/help.md
autonomous: true

must_haves:
  truths:
    - "User can run /grd:insights <dataset> to generate business-friendly EDA report"
    - "Console displays plain English INSIGHTS_SUMMARY.md with Rich formatting"
    - "DATA_REPORT.md saved to file with full technical details"
    - "Explorer agent detects insights mode and uses insights.py module"
    - "Help documentation includes insights command with usage examples"
  artifacts:
    - path: ".claude/commands/grd/insights.md"
      provides: "Insights command orchestration"
      contains: "grd:insights"
    - path: ".claude/agents/grd-explorer.md"
      provides: "Explorer agent with insights mode support"
      contains: "insights_mode"
    - path: ".claude/commands/grd/help.md"
      provides: "Help documentation with insights command"
      contains: "/grd:insights"
  key_links:
    - from: ".claude/commands/grd/insights.md"
      to: ".claude/agents/grd-explorer.md"
      via: "Task spawn with insights mode context"
      pattern: "profiling_mode.*insights"
    - from: ".claude/agents/grd-explorer.md"
      to: ".claude/get-research-done/lib/insights.py"
      via: "Import and call generate_insights()"
      pattern: "from.*insights import|generate_insights"
---

<objective>
Create the /grd:insights command and integrate insights mode into the Explorer agent.

Purpose: Enable users to generate accessible data insights with a single command, producing both technical reports (saved) and plain English summaries (displayed).

Output:
- `insights.md` command file for /grd:insights
- Updated `grd-explorer.md` agent with insights mode detection
- Updated `help.md` with insights command documentation
</objective>

<execution_context>
@/Users/evanowen/.claude/get-shit-done/workflows/execute-plan.md
@/Users/evanowen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-accessible-insights/13-CONTEXT.md
@.planning/phases/13-accessible-insights/13-RESEARCH.md
@.planning/phases/13-accessible-insights/13-01-SUMMARY.md
@.claude/commands/grd/quick-explore.md
@.claude/agents/grd-explorer.md
@.claude/commands/grd/help.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /grd:insights command file</name>
  <files>
    .claude/commands/grd/insights.md
  </files>
  <action>
Create insights.md command file following the pattern from quick-explore.md:

```markdown
---
name: grd:insights
description: Generate plain English data insights for business analyst audience - no code, no jargon
allowed-tools:
  - Read
  - Bash
  - Write
  - Task
---

<objective>

Generate accessible data insights for business analyst audience without technical jargon.

This command produces two outputs:
1. **DATA_REPORT.md** (saved to file) - Full technical details for data scientists
2. **INSIGHTS_SUMMARY.md** (displayed in chat) - Plain English with "What This Means" explanations

**Key features:**
- Executive summary (TL;DR) at top
- "5 Things to Know" scannable format
- Every statistic explained in plain English
- Actionable recommendations with example code
- LLM prompts for further exploration (copy-paste ready)

**Use cases:**
- Sharing data findings with non-technical stakeholders
- Understanding data quality before modeling
- Communicating insights to business analysts
- Generating exploration prompts for ChatGPT/Claude

**After this command:** Share INSIGHTS_SUMMARY.md with stakeholders, or use LLM prompts for deeper analysis.

</objective>

<execution_context>

@./.claude/get-research-done/templates/data-report.md

</execution_context>

<process>

## Phase 1: Setup and Data Path Resolution

**Check if project initialized:**

```bash
[ ! -f .planning/PROJECT.md ] && echo "ERROR: Project not initialized. Run /grd:new-project first." && exit 1
```

**Determine data path:**

If [path] argument provided:
- Use it directly
- Validate path exists

If no argument:
- Check for common data directories (./data/, ./datasets/, ./raw/)
- If found, list contents and ask user to select
- If not found, ask user to provide path interactively

**Validate data source:**

```bash
# Check if path exists
if [ -f "$DATA_PATH" ]; then
    echo "Single file: $DATA_PATH"
elif [ -d "$DATA_PATH" ]; then
    echo "Directory: $DATA_PATH"
    find "$DATA_PATH" -type f \( -name "*.csv" -o -name "*.parquet" -o -name "*.json" -o -name "*.jsonl" \) | head -20
else
    echo "ERROR: Path not found: $DATA_PATH"
    exit 1
fi
```

## Phase 2: Spawn Explorer Agent with Insights Mode

Display insights banner:
```
------------------------------------------------
 GRD > ACCESSIBLE INSIGHTS
------------------------------------------------

Generating plain English data insights...

Analyzing: [data_path]
Mode: insights (business analyst audience)
```

Spawn grd-explorer agent with insights mode context:

```
Task(prompt="
<data_source>
Path: [data_path]
Type: [file | directory]
</data_source>

<profiling_mode>
insights

Insights mode:
- Generate TWO outputs: DATA_REPORT.md (technical) + INSIGHTS_SUMMARY.md (plain English)
- Every statistic gets 'What This Means' explanation
- Use severity indicators: Critical, Note, Healthy
- Include actionable recommendations with example code
- Generate 3-5 LLM prompts for further exploration
- Display INSIGHTS_SUMMARY.md to console with Rich formatting
- Save both files to .planning/ directory
</profiling_mode>

<project_context>
@.planning/PROJECT.md

Extract:
- What this project is about
- Target variable (if ML project)
- Business context for explanations
</project_context>

<instructions>
Execute INSIGHTS data exploration workflow:

1. Load data (handle CSV, Parquet, JSON, JSONL)
2. Analyze data quality, distributions, relationships
3. Identify critical issues (>50% missing, constants, leakage)
4. Identify moderate issues (20-50% missing, outliers)
5. Identify positive findings (healthy patterns)
6. Generate key takeaways ('5 Things to Know')
7. Generate recommendations with specific code examples
8. Generate 3-5 contextual LLM prompts
9. Render DATA_REPORT.md (technical) via template
10. Render INSIGHTS_SUMMARY.md (plain English) via template
11. Display INSIGHTS_SUMMARY.md to console with Rich.Markdown
12. Save both files to .planning/

Use insights.py module:
```python
from insights import generate_insights
generate_insights(df, target_col=target_col, output_dir='.planning')
```

Key: Every statistic MUST have plain English explanation.
</instructions>

<output>
1. Console display of INSIGHTS_SUMMARY.md (Rich formatted)
2. .planning/DATA_REPORT.md (technical, saved)
3. .planning/INSIGHTS_SUMMARY.md (plain English, saved)
</output>
", subagent_type="grd-explorer", model="sonnet", description="Generate accessible data insights")
```

## Phase 3: Present Results

After agent completes, present summary:

```
------------------------------------------------
 GRD > INSIGHTS COMPLETE
------------------------------------------------

Plain English summary displayed above.

Files saved:
  Technical report: .planning/DATA_REPORT.md
  Plain English: .planning/INSIGHTS_SUMMARY.md

Share INSIGHTS_SUMMARY.md with stakeholders, or use the
LLM prompts at the bottom for deeper analysis.

For rigorous leakage analysis: /grd:explore
```

</process>

<arguments>

**[path]** (optional)
- Path to data file or directory
- Examples: `./data/train.csv`, `./datasets/`, `data.parquet`
- If omitted, will prompt interactively

**[--target <column>]** (optional)
- Target column for modeling-focused insights
- Enables class imbalance detection, feature recommendations

</arguments>

<examples>

**Generate insights for CSV file:**
```
/grd:insights ./data/train.csv
```

**Generate insights with target column:**
```
/grd:insights ./data/train.csv --target churn
```

**Interactive mode:**
```
/grd:insights
# Will prompt for path
```

</examples>

<output>

**Console output (INSIGHTS_SUMMARY.md):**
- TL;DR (most critical finding)
- 5 Things to Know (scannable headlines)
- Data Overview with "What This Means"
- Critical Issues with explanations
- Recommendations with code examples
- LLM Prompts for further exploration

**File outputs:**
- `.planning/DATA_REPORT.md` - Technical report for data scientists
- `.planning/INSIGHTS_SUMMARY.md` - Plain English for business analysts

</output>

<success_criteria>

- [ ] Data path resolved (from argument or user input)
- [ ] grd-explorer agent spawned with insights mode context
- [ ] INSIGHTS_SUMMARY.md displayed to console with Rich formatting
- [ ] DATA_REPORT.md saved to .planning/
- [ ] INSIGHTS_SUMMARY.md saved to .planning/
- [ ] LLM prompts included in output

</success_criteria>
```
  </action>
  <verify>
```bash
# Verify command file exists and has correct structure
ls -la .claude/commands/grd/insights.md
grep -c "grd:insights" .claude/commands/grd/insights.md
grep -c "profiling_mode" .claude/commands/grd/insights.md
grep -c "INSIGHTS_SUMMARY" .claude/commands/grd/insights.md
grep -c "DATA_REPORT" .claude/commands/grd/insights.md
```
  </verify>
  <done>
- insights.md command file created with proper frontmatter
- Command spawns grd-explorer with insights mode context
- Process includes data path resolution, agent spawn, results presentation
- Arguments documented ([path], [--target])
- Success criteria match requirements
  </done>
</task>

<task type="auto">
  <name>Task 2: Update grd-explorer.md agent for insights mode</name>
  <files>
    .claude/agents/grd-explorer.md
  </files>
  <action>
Update grd-explorer.md to detect and handle insights mode in addition to existing quick and full modes.

**Add mode detection pattern (similar to quick mode):**

In the mode detection section, add insights mode:
```
## Mode Detection

Detect profiling_mode from context:
- `profiling_mode: quick` -> Quick explore path
- `profiling_mode: insights` -> Insights path (NEW)
- `profiling_mode: full` or default -> Full explore path
```

**Add insights mode workflow:**

```
## Insights Mode Workflow

When profiling_mode is 'insights':

1. Load data using standard data loading
2. Run comprehensive analysis (same as full explore)
3. Use insights.py module for output generation:

```python
import sys
sys.path.insert(0, '.claude/get-research-done/lib')
from insights import generate_insights

generate_insights(df, target_col=target_col, output_dir='.planning')
```

4. The module handles:
   - Plain English explanations for all statistics
   - Severity-aware language (Critical/Note/Healthy)
   - Actionable recommendations with code examples
   - LLM prompt generation
   - Template rendering via Jinja2
   - Console output via Rich
   - File saving to output_dir

Key differences from quick mode:
- Full analysis depth (not limited)
- Both technical AND plain English output
- Recommendations with example code
- LLM prompts for further exploration
```

**Update mode detection regex patterns:**

Add pattern for insights mode alongside quick mode detection.
  </action>
  <verify>
```bash
# Verify agent update
grep -c "insights" .claude/agents/grd-explorer.md
grep -c "profiling_mode" .claude/agents/grd-explorer.md
grep -c "generate_insights" .claude/agents/grd-explorer.md
```
  </verify>
  <done>
- grd-explorer.md updated with insights mode detection
- Insights workflow documented with insights.py usage
- Mode detection patterns include quick, insights, full
- Key differences from quick mode explained
  </done>
</task>

<task type="auto">
  <name>Task 3: Update help.md with insights command</name>
  <files>
    .claude/commands/grd/help.md
  </files>
  <action>
Update help.md to include the insights command. Add it in the Data Exploration section near quick-explore.

**Add to Data Exploration section:**

```markdown
### Data Exploration

| Command | Description |
|---------|-------------|
| `/grd:explore [path]` | Full statistical profiling with rigorous leakage detection |
| `/grd:quick-explore [path]` | Fast EDA for team communication (60-second target) |
| `/grd:insights [path]` | **NEW** Plain English insights for business analysts |

#### /grd:insights

Generate accessible data insights for non-technical stakeholders.

**Outputs:**
- `DATA_REPORT.md` (technical) - saved to file
- `INSIGHTS_SUMMARY.md` (plain English) - displayed in chat + saved

**Features:**
- TL;DR executive summary
- "5 Things to Know" scannable format
- Every statistic explained in plain English
- Actionable recommendations with example code
- LLM prompts for further exploration

**Usage:**
```bash
/grd:insights ./data/train.csv              # Basic usage
/grd:insights ./data/train.csv --target y   # With target column
```

**Workflow:**
```
/grd:insights data.csv
   -> Technical report: .planning/DATA_REPORT.md
   -> Plain English: .planning/INSIGHTS_SUMMARY.md (displayed)
   -> Share INSIGHTS_SUMMARY.md with stakeholders
```
```

**Update progressive path documentation:**

In any workflow section showing exploration paths, add insights as an option:

```markdown
## Exploration Paths

| Path | Commands | Best For |
|------|----------|----------|
| Quick | `/grd:quick-explore` | Fast sanity check, team sharing |
| Accessible | `/grd:insights` | Non-technical stakeholders, business analysts |
| Full | `/grd:explore` | Rigorous analysis, production pipelines |

**Progressive exploration:**
1. Start with `/grd:quick-explore` for fast overview
2. Use `/grd:insights` to share findings with stakeholders
3. Run `/grd:explore` for full rigor before modeling
```
  </action>
  <verify>
```bash
# Verify help update
grep -c "/grd:insights" .claude/commands/grd/help.md
grep -c "INSIGHTS_SUMMARY" .claude/commands/grd/help.md
grep -c "business analyst" .claude/commands/grd/help.md
```
  </verify>
  <done>
- help.md includes /grd:insights command in Data Exploration section
- Command description, outputs, features documented
- Usage examples with --target flag
- Workflow diagram showing output files
- Progressive exploration path documented
  </done>
</task>

</tasks>

<verification>

**Command file verification:**
```bash
cat .claude/commands/grd/insights.md | head -50
```

**Agent verification:**
```bash
grep -A5 "insights" .claude/agents/grd-explorer.md
```

**Help verification:**
```bash
grep -A10 "insights" .claude/commands/grd/help.md
```

**Full integration test:**
Note: Full integration testing deferred to Phase 14.

</verification>

<success_criteria>

- [ ] insights.md command file exists with proper structure
- [ ] Command spawns grd-explorer with insights mode context
- [ ] grd-explorer.md updated with insights mode detection and workflow
- [ ] help.md includes insights command documentation
- [ ] Progressive exploration path documented (quick -> insights -> full)

</success_criteria>

<output>
After completion, create `.planning/phases/13-accessible-insights/13-02-SUMMARY.md`
</output>
