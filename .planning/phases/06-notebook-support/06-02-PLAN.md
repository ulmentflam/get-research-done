---
phase: 06-notebook-support
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - get-research-done/templates/graduated-script.md
  - notebooks/exploration/.gitkeep
  - src/experiments/.gitkeep
autonomous: true

must_haves:
  truths:
    - "Graduated script template includes source notebook reference"
    - "Graduated script template includes refactoring guidance"
    - "Exploration directory exists for notebooks"
    - "Validated scripts directory exists"
  artifacts:
    - path: "get-research-done/templates/graduated-script.md"
      provides: "Template for graduated Python scripts with metadata header"
      contains: "Source notebook:"
      min_lines: 40
    - path: "notebooks/exploration/.gitkeep"
      provides: "Directory marker for exploration notebooks"
    - path: "src/experiments/.gitkeep"
      provides: "Directory marker for validated scripts"
  key_links:
    - from: "get-research-done/templates/graduated-script.md"
      to: "notebooks/exploration/"
      via: "Source notebook reference placeholder"
      pattern: "{{source_notebook}}"
---

<objective>
Create templates and directory structure for notebook exploration and graduation workflow.

Purpose: Establish the separation between `notebooks/exploration/` (exploratory notebooks) and `src/experiments/` (validated scripts) per CONTEXT.md, with a template that guides users through graduation refactoring.

Output:
- `get-research-done/templates/graduated-script.md` - Template for graduated Python scripts
- `notebooks/exploration/.gitkeep` - Scaffold exploration directory
- `src/experiments/.gitkeep` - Scaffold validated scripts directory
</objective>

<execution_context>
@/Users/evanowen/.claude/get-research-done/workflows/execute-plan.md
@/Users/evanowen/.claude/get-research-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-notebook-support/06-CONTEXT.md
@.planning/phases/06-notebook-support/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create graduated script template</name>
  <files>get-research-done/templates/graduated-script.md</files>
  <action>
Create a template for graduated Python scripts that includes:

1. **Header metadata block (docstring):**
   - Experiment name
   - Source notebook path (notebooks/exploration/...)
   - Source run directory (experiments/run_NNN/)
   - Critic verdict and date
   - Graduation timestamp

2. **Refactoring checklist (comments):**
   Per RESEARCH.md, graduated scripts need manual refactoring:
   - [ ] Remove/convert magic commands (grep "^%")
   - [ ] Extract code into functions
   - [ ] Replace parameter cell with argparse
   - [ ] Add docstrings and type hints
   - [ ] Set all random seeds explicitly
   - [ ] Write tests for core functions

3. **Template structure:**
```python
"""
Validated experiment: {{experiment_name}}

Source notebook: {{source_notebook}}
Source run: {{source_run}}
Critic verdict: {{critic_verdict}} ({{verdict_date}})
Graduated: {{graduation_timestamp}}

MANUAL REFACTORING REQUIRED:
- [ ] Remove/convert magic commands (grep "^%")
- [ ] Extract code into functions
- [ ] Replace parameter cell with argparse
- [ ] Add docstrings and type hints
- [ ] Set all random seeds explicitly
- [ ] Write tests for core functions
"""

import argparse
import random
import numpy as np

# Uncomment if using PyTorch:
# import torch


def set_random_seeds(seed: int = 42):
    """Set all random seeds for reproducibility."""
    random.seed(seed)
    np.random.seed(seed)
    # Uncomment for PyTorch:
    # torch.manual_seed(seed)
    # torch.cuda.manual_seed_all(seed)
    # torch.backends.cudnn.deterministic = True
    # torch.backends.cudnn.benchmark = False


def main(args):
    """Main experiment entry point."""
    set_random_seeds(args.random_seed)

    # TODO: Implement experiment logic here
    # Extracted from: {{source_notebook}}
    pass


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='{{experiment_name}}')
    parser.add_argument('--random-seed', type=int, default=42, help='Random seed for reproducibility')
    # TODO: Add experiment-specific arguments

    args = parser.parse_args()
    main(args)
```

4. **Placeholders to fill:**
   - `{{experiment_name}}` - From OBJECTIVE.md or notebook name
   - `{{source_notebook}}` - Path to source notebook (e.g., notebooks/exploration/001_initial.ipynb)
   - `{{source_run}}` - Run directory that passed (e.g., experiments/run_003_baseline)
   - `{{critic_verdict}}` - PROCEED verdict
   - `{{verdict_date}}` - ISO 8601 date
   - `{{graduation_timestamp}}` - ISO 8601 timestamp

Write this as a template file that graduation workflow will populate.
  </action>
  <verify>
Check file exists: `ls get-research-done/templates/graduated-script.md`
Check contains placeholders: `grep -c "{{" get-research-done/templates/graduated-script.md`
Check contains refactoring checklist: `grep "MANUAL REFACTORING" get-research-done/templates/graduated-script.md`
  </verify>
  <done>
- Template file created with metadata header block
- Template includes all placeholders for graduation metadata
- Template includes refactoring checklist comments
- Template includes seed-setting boilerplate
- Template includes argparse skeleton
  </done>
</task>

<task type="auto">
  <name>Task 2: Create directory scaffolds</name>
  <files>notebooks/exploration/.gitkeep, src/experiments/.gitkeep</files>
  <action>
Create directory structure for notebook workflow per CONTEXT.md:

1. **Create `notebooks/exploration/.gitkeep`:**
   ```bash
   mkdir -p notebooks/exploration
   touch notebooks/exploration/.gitkeep
   ```

   Add a brief README to .gitkeep explaining the directory:
   ```
   # Exploration Notebooks

   This directory contains exploratory Jupyter notebooks.

   ## Conventions
   - Number notebooks sequentially: 001_initial_test.ipynb, 002_revised_method.ipynb
   - Organize subdirectories at your discretion
   - Notebooks here run through GRD validation loop via /grd:research
   - On Critic PROCEED verdict, graduate notebooks to src/experiments/ using /grd:graduate

   ## Graduation Requirements
   - Random seed must be explicitly set (numpy, torch, random, etc.)
   - Cell tagged 'parameters' for parameterization
   - Hardcoded paths: advisory warning (doesn't block)

   Original notebooks stay here after graduation (not archived/deleted).
   ```

2. **Create `src/experiments/.gitkeep`:**
   ```bash
   mkdir -p src/experiments
   touch src/experiments/.gitkeep
   ```

   Add a brief README to .gitkeep explaining the directory:
   ```
   # Validated Experiments

   This directory contains graduated Python scripts from exploration notebooks.

   ## How scripts arrive here
   1. Notebook runs through GRD validation loop (/grd:research)
   2. Critic returns PROCEED verdict
   3. User graduates notebook via /grd:graduate
   4. nbconvert creates .py file, template adds metadata header

   ## Script requirements
   - Self-contained: runs without notebook dependencies
   - Parameterized: argparse CLI arguments
   - Reproducible: explicit random seeds
   - Tested: core functions have tests

   ## Traceability
   Each script header references its source notebook:
   - Source notebook: notebooks/exploration/...
   - Source run: experiments/run_NNN/
   - Critic verdict: PROCEED (date)
   ```

Note: Using .gitkeep as README file is intentional - it serves dual purpose of keeping empty directory in git AND documenting the directory's purpose.
  </action>
  <verify>
Check directories exist:
- `ls -la notebooks/exploration/`
- `ls -la src/experiments/`
Check .gitkeep files have content:
- `wc -l notebooks/exploration/.gitkeep`
- `wc -l src/experiments/.gitkeep`
  </verify>
  <done>
- notebooks/exploration/ directory exists with .gitkeep
- src/experiments/ directory exists with .gitkeep
- Both .gitkeep files document their directory's purpose
- Directory structure matches CONTEXT.md specification
  </done>
</task>

</tasks>

<verification>
1. Template exists and has placeholders: `grep "{{" get-research-done/templates/graduated-script.md | wc -l`
2. Exploration directory exists: `test -d notebooks/exploration && echo "OK"`
3. Experiments directory exists: `test -d src/experiments && echo "OK"`
4. Both scaffold files have documentation content
</verification>

<success_criteria>
- graduated-script.md template created with all required sections
- notebooks/exploration/ directory scaffolded
- src/experiments/ directory scaffolded
- Directory separation matches CONTEXT.md specification
</success_criteria>

<output>
After completion, create `.planning/phases/06-notebook-support/06-02-SUMMARY.md`
</output>
